language: go

go:
- release
- tip

env:
  global:
  - GOBIN=${HOME}/bin
  - PATH=${PATH}:${GOBIN}
  - secure: L56CDUooHBRiMioOCwqtyGBQiSPSyP3R0wqbcBrZhka36VfnXLEhVW+lAeaJvW4LO6mf30VRlttA55OBcxgoQZgKs1n9ODlLkCq0LyGEeDEQmZevW62cS5XDZ2HfIlh9mZo+f9yQuBu1KMSUgQ7AQYlz24pk5jbNsNPngxAS/1U=

install:
- mkdir ${HOME}/bin
- go get code.google.com/p/go.tools/cmd/vet
- go get github.com/golang/lint/golint
- go get code.google.com/p/go.tools/cmd/cover
- go get github.com/mattn/goveralls
- go get github.com/modocache/gover

script:
- golint .
- go vet ./...
- go get -t ./...
- go test -v -race ./...
- go list -f '{{if len .TestGoFiles}}"go test -coverprofile={{.Dir}}/.coverprofile {{.ImportPath}}"{{end}}' ./... | xargs -i sh -c {}
- gover
- goveralls -coverprofile=gover.coverprofile -service=travis-ci -repotoken=$COVERALLS_TOKEN
